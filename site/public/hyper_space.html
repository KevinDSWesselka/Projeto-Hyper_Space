<!DOCTYPE html>
<html lang="pt_br">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/base.css">
  <link rel="stylesheet" href="./css/hyper_space.css">
  <link rel="shortcut icon"
    href="https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/15134c4c-39a0-4476-8a3f-2c5d96ce27d6/d9b680y-fdeae898-390c-4bd9-b0f7-c48693dd602e.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzE1MTM0YzRjLTM5YTAtNDQ3Ni04YTNmLTJjNWQ5NmNlMjdkNlwvZDliNjgweS1mZGVhZTg5OC0zOTBjLTRiZDktYjBmNy1jNDg2OTNkZDYwMmUucG5nIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0.CQxZXahvjoULgcl24xgXrIbQs-KKCo8mrd92vhouwDY" />
  <title>Hyper-Space | Home</title>
</head>

<body>
  <div class="header">
    <div class="magin_nav_bar">

    </div>
    <div class="nav_bar">
      <ul>
        <li><a href="./index.html">Home</a></li>
        <li><a id="link_select" href="">Hyper Space</a></li>
        <li><a href="./paths.html">Paths of the Force</a></li>
        <li><a href="./cadastro.html">Sing-in</a></li>
        <li><a href="./login.html">Log-in</a></li>
      </ul>
    </div>
  </div>
  <div id="conteudo">
    <div id="container">
      <h1>HYPER-SPACE</h1>
      <img src="" alt="">
      <p id="descricoes">
        <span id="span_lado"></span>

      <div id="container_characters">

      </div>
    </div>
    <!-- 

        <span>
          <div>
            <h1>YODA</h1>
          </div>
          <div>
            <img height: 250px;" src="https://amenteemaravilhosa.com.br/wp-content/uploads/2022/01/yoda-1024x598-1.jpg" alt="">
          </div>
          <div width: 470px;">
            <div id="grafico">
              <h3>Tendencia da Força de CAVALO</h3>
              <span>20% Jedi</span>
              <div width: 20%; height: 30px; margin: 5px; background-color: green; transition: 2.5s;"></div>
              <span>80% Sith</span>
              <div width: 80%; height: 30px; margin: 5px; background-color: red; transition: 2.5s;"></div>
            </div>
            <div width: 250px;" id="grafico">
              <h3>Tendencia da Força de antonio</h3>
              11% Jedi<div width: 11%; height: 30px; margin: 5px; background-color: blue; transition: 2.5s;"></div>
              89% Sith<div width: 89%; height: 30px; margin: 5px; background-color: red; transition: 2.5s;"></div>
            </div>
          </div>
          <div>
            <span>texttexto</span>
          </div>
          <span >
            <div class="like" onclick="btn_linke()">LIKE</div>
          </span>
          <span >0</span>
          
        </span> -->

    </p>
  </div>
  </div>
  <div class="footer">
    <div class="container_footer">
      <a href="https://www.linkedin.com/in/kevin-s-wesselka-systems-developer/">
        <img src="https://cdn4.iconfinder.com/data/icons/social-media-icons-the-circle-set/48/linkedin_circle-512.png"
          alt="">
      </a>
      <a href="https://github.com/KevinDSWesselka">
        <img src="https://cdn.icon-icons.com/icons2/2429/PNG/512/github_logo_icon_147285.png" alt="">
      </a>
      <a href="https://www.instagram.com/">
        <img src="https://cpaq.ufms.br/files/2022/03/Instagram-logo-free-download-PNG-e1647376733700.png" alt="">
      </a>
    </div>
    <p>
      Star Wars - Hyper Space™
    </p>
  </div>
</body>

</html>

<script>

  var descricoes = document.getElementById("descricoes")
  var likes = 0;

  function lado_da_forca() {
    if (sessionStorage.JEDI > sessionStorage.SITH) {
      span_lado.innerHTML = `Vejo que você tem <span style="color: blue;"> ${sessionStorage.JEDI}% de vocação ao lado JEDI</span>`
    } else if (sessionStorage.JEDI < sessionStorage.SITH) {
      span_lado.innerHTML = `Vejo que você tem <span style="color: red;"> ${sessionStorage.SITH}% de vocação ao lado SITH</span>`
    } else if (sessionStorage.JEDI == 'null') {
      span_lado.innerHTML = `Você ainda não obteve acesso a força! 
      <a href="./paths.html">Click aqui e faça a passe pelo teste.</a>`;

      grafico.innerHTML = `Você ainda não obteve acesso a força! 
      <a href="./paths.html">Click aqui e faça a passe pelo teste.</a>`;
    } else if (sessionStorage.length == 0) {
      span_lado.innerHTML = `Você ainda não obteve acesso a força! 
      <a href="./paths.html">Click aqui e faça a passe pelo teste.</a>`;

      grafico.innerHTML = `Você ainda não obteve acesso a força! 
      <a href="./paths.html">Click aqui e faça a passe pelo teste.</a>`;
    } else {
      span_lado.innerHTML = `Vejo que você tem <span style="color: gold;"> ${sessionStorage.SITH}% SITH e ${sessionStorage.JEDI}% JEDI, você tem o equilibrio da força </span>`
    }
  }

  window.onload = () => {
    fetch("/personagens/pegar_personagens", {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      },
    }).then(async function (response) {
      const characters = await response.json();
      for (i = 0; i < characters.length; i++) {
        const character = characters[i];

        var btnContainerId = `btn_container_${character.id_personagem}`; // identificador exclusivo para o contêiner do botão

        container_characters.innerHTML += `
        <span>
          <div>
            <h1>${character.nome_personagem}</h1>
          </div>
          <div>
            <img style=" width: 100%; height: 450px;" src="${character.url_personagem}" alt="">
          </div>
          
          <div width: 470px;">
            <div class="grafico">
              <h3>Tendencia da Força de ${character.nome_personagem}</h3>
              <span>${character.jedi_por_cen}% Jedi</span>
              <div style="width: ${character.jedi_por_cen}%; height: 30px; margin: 5px; background-color: green;"></div>
              <span>${character.sith_por_cen}% Sith</span>
              <div style="width: ${character.sith_por_cen}%; height: 30px; margin: 5px; background-color: red;"></div>
            </div>
            <div class="grafico">
              <h3>Tendencia da Força de ${sessionStorage.NOME_USUARIO}</h3>
              <span>${sessionStorage.JEDI}% Jedi</span>
              <div style="width: ${sessionStorage.JEDI}%; height: 30px; margin: 5px; background-color: green;"></div>
              <span>${sessionStorage.SITH}% Sith</span>
              <div style="width: ${sessionStorage.SITH}%; height: 30px; margin: 5px; background-color: red;"></div>
            </div>
          </div>

          <div>
            <button title="Sera contabilizado apenas uma vez!" class="like" onclick="likeCharacter(${character.id_personagem})">Prestar respeito</button>
            <span id="${btnContainerId}"></span>
          </div>


          <div>
            ${character.desc_texto}
          </div>
        </span>
      `;

        getCurtida(character.id_personagem, btnContainerId);
      }
    });
  };

  function likeCharacter(characterId) {
    alert(`Sua admiração foi feita e não pode ser desfeita...`);
    window.location.reload();
    fetch("/curtidas/post-curtida", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        idUsuario: sessionStorage.ID_USUARIO,
        idPersonagem: characterId,
      }),
    }).then(async function (response) { });
  }

  function getCurtida(characterId, containerId) {
    fetch(`/curtidas/get-curtida/${characterId}`, {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
      }
    }).then(async function (response) {
      const curtidas = await response.json()
      const span = document.getElementById(containerId);
      span.insertAdjacentHTML('beforeend', `<span class="contador-curtidas">${curtidas[0].curtidas}</span>`);
    });
  }

  lado_da_forca()

</script>